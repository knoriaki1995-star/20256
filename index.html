<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>ï¼–å¹´ç”Ÿç®—æ•°ã‚¯ã‚¤ã‚º</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --bg:#f6f7fb; --card:#ffffff; --ink:#222; --muted:#667; --brand:#4e6cf4; --ok:#2aa776; --warn:#e6a100; --danger:#d33;
    --path:#e9ecff; --path-line:#c9d0ff; --hero:#4e6cf4; --treasure:#f2c94c;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Yu Gothic UI","Yu Gothic",Meiryo,sans-serif;background:var(--bg);color:var(--ink)}
  header{padding:14px 18px;background:var(--card);box-shadow:0 2px 12px rgba(0,0,0,.06);position:sticky;top:0;z-index:20}
  h1{font-size:20px;margin:0}
  .wrap{max-width:1100px;margin:18px auto;padding:0 16px}
  .row{display:flex;flex-wrap:wrap;gap:12px}
  .card{background:var(--card);border-radius:16px;box-shadow:0 4px 18px rgba(0,0,0,.06);padding:16px}
  .login,.controls,.quiz,.collection,.teacher,.adventure{width:100%}
  input[type="text"],select{width:100%;padding:10px 12px;border:1px solid #ddd;border-radius:10px;font-size:16px;background:#fff}
  button{cursor:pointer;border:none;border-radius:12px;padding:10px 14px;font-weight:700}
  .btn{background:var(--brand);color:#fff}
  .btn.secondary{background:#e6e8ff;color:#2b2f7e}
  .btn.ghost{background:#eef0f7;color:#2b2f7e}
  .btn.warn{background:#fff3e1;color:#6b4b00;border:1px solid #ffe1a8}
  .muted{color:var(--muted)}
  .small{font-size:12px}
  .right{display:flex;gap:8px;align-items:center;justify-content:flex-end}

  /* Quiz */
  .quiz h2{margin:0 0 8px}
  .options{display:grid;gap:10px;margin-top:12px}
  .opt{padding:12px;border:2px solid #e7e7ee;border-radius:12px;background:#fff;text-align:left}
  .opt.correct{border-color:var(--ok)}
  .opt.wrong{border-color:var(--danger)}
  .result-area{margin-top:12px}
  .progressbar{height:10px;background:#eef0f7;border-radius:999px;overflow:hidden}
  .progressbar > span{display:block;height:100%;background:linear-gradient(90deg,var(--ok),#67d6a7)}

  /* Adventure path */
  .adventure{position:relative;overflow:hidden}
  .path-wrap{background:linear-gradient(180deg,#fdfdff, #f6f7fb);border-radius:14px;padding:16px;border:1px solid #eef0ff}
  .path{display:grid;grid-template-columns:repeat(auto-fit,minmax(24px,1fr));gap:8px;align-items:center}
  .node{position:relative;height:26px;background:var(--path);border:1px solid var(--path-line);border-radius:999px}
  .node.done{background:#dff6ea;border-color:#b7ebd1}
  .node .label{position:absolute;top:-22px;left:50%;transform:translateX(-50%);font-size:10px;color:#889}
  .node.treasure::after{content:"ğŸ";position:absolute;right:-6px;top:-16px;font-size:16px}
  .hero{position:absolute;top:50%;transform:translate(-50%,-50%);width:28px;height:28px;border-radius:50%;background:var(--hero);display:flex;align-items:center;justify-content:center;color:#fff;font-size:16px;box-shadow:0 6px 16px rgba(78,108,244,.35);transition:left .8s cubic-bezier(.2,.7,.2,1)}
  .hero::after{content:"ğŸ§­";filter:drop-shadow(0 2px 2px rgba(0,0,0,.12))}

  /* Split layout */
  .split{display:grid;grid-template-columns:1.2fr .8fr;gap:12px}
  @media (max-width:900px){.split{grid-template-columns:1fr}}

  /* Treasure modal */
  .modal-backdrop{position:fixed;inset:0;background:rgba(10,16,32,.55);display:none;align-items:center;justify-content:center;z-index:50}
  .modal{background:#101735;color:#e6ecff;border:1px solid #3041a7;border-radius:16px;padding:18px;max-width:520px;width:92%;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.4)}
  .modal h3{margin:0 0 6px}
  .modal p{margin:0 0 10px;color:#b7c0ff}
  .modal img{max-width:240px;border-radius:12px;box-shadow:0 10px 28px rgba(0,0,0,.35);background:#0c1126}
  .modal .chest{font-size:48px;animation:pop .6s ease both}
  @keyframes pop{0%{transform:scale(.5);opacity:0}100%{transform:scale(1);opacity:1}}

  /* Collection */
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:12px}
  .grid img{width:100%;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.12)}
  .pill{padding:6px 10px;border-radius:999px;background:#eef0f7;font-size:12px}
  .badge{background:#fff3c2;color:#6b4b00;border:1px solid #ffe28a}

  /* Footer mini help */
  footer{padding:20px;color:#98a; font-size:12px}
</style>
</head>
<body>
<header>
  <div class="wrap row" style="align-items:center;justify-content:space-between;">
    <h1>ï¼–å¹´ç”Ÿç®—æ•°ã‚¯ã‚¤ã‚º</h1>
    <div class="right">
      <button class="btn ghost" id="teacherBtn">æ•™å¸«ãƒ¢ãƒ¼ãƒ‰</button>
      <button class="btn secondary" id="showCollectionBtn">ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</button>
    </div>
  </div>
</header>

<div class="wrap">
  <!-- Login -->
  <section class="card login" id="loginCard">
    <h2 style="margin:0 0 8px">å†’é™ºã«å‡ºã‚‹ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ï¼‰</h2>
    <p class="muted small">ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã§OKã€‚åŒã˜åå‰ã§ç¶šãã‹ã‚‰å†é–‹ã§ãã¾ã™ã€‚</p>
    <div class="row">
      <div style="flex:1"><input id="nickname" type="text" placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å…¥åŠ›" /></div>
      <div style="flex:0 0 auto"><button class="btn" id="loginBtn">ã¯ã˜ã‚ã‚‹</button></div>
    </div>
  </section>

  <!-- Adventure Path -->
  <section class="card adventure" id="adventureCard" style="display:none">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:8px">
      <div class="pill">ğŸ§‘â€ğŸš€ å†’é™ºè€…ï¼š<b id="currentUserLabel">-</b></div>
      <div class="pill badge">å°å˜å…ƒã‚’<span style="font-weight:700">å…¨å•æ­£è§£</span>ã§å®ç®±ã‚ªãƒ¼ãƒ—ãƒ³ï¼</div>
      <div class="pill">è¸ç ´ï¼š<span id="clearedCount">0</span>/<span id="totalSubunits">0</span></div>
    </div>
    <div class="path-wrap">
      <div id="path" class="path"></div>
      <div id="hero" class="hero" style="left:0%"></div>
    </div>
  </section>

  <div class="split">
    <!-- Quiz -->
    <section class="card quiz" id="quizCard" style="display:none">
      <h2 id="subunitTitle">-</h2>
      <div class="muted small" id="qCounter">1 / 5</div>
      <div id="questionText" style="margin-top:8px;font-size:18px;font-weight:600"></div>
      <div id="options" class="options"></div>
      <div id="feedback" class="result-area"></div>
      <div style="margin-top:12px;display:flex;gap:8px;align-items:center;justify-content:space-between">
        <div class="row" style="gap:8px">
          <button class="btn ghost" id="prevQ">â† å‰ã®å•é¡Œ</button>
          <button class="btn" id="nextQ">æ¬¡ã®å•é¡Œ â†’</button>
        </div>
        <div style="min-width:220px">
          <div class="progressbar"><span id="progressBar" style="width:0%"></span></div>
          <div class="muted small" style="margin-top:6px">å°å˜å…ƒã‚¯ãƒªã‚¢çŠ¶æ³ï¼š<span id="progressText">0/0</span></div>
        </div>
      </div>
    </section>

    <!-- Collection -->
    <section class="card collection" id="collectionCard" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
        <h2 style="margin:0">ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</h2>
        <button class="btn ghost" id="hideCollectionBtn">é–‰ã˜ã‚‹</button>
      </div>
      <p class="muted small">å®ç®±ã‹ã‚‰å‡ºã¦ããŸä»²é–“ãŸã¡ã€‚ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã‚’ç›®æŒ‡ãã†ï¼ï¼ˆè¢«ã‚Šã‚ã‚Šï¼‰</p>
      <div id="collectionGrid" class="grid"></div>
    </section>
  </div>

  <!-- Teacher -->
  <section class="card teacher" id="teacherCard" style="display:none">
    <h2 style="margin:0 0 8px">æ•™å¸«ãƒ¢ãƒ¼ãƒ‰</h2>
    <div class="row">
      <button class="btn ghost" id="switchUserBtn">ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ‡æ›¿</button>
      <button class="btn" id="exportBtn">é€²æ—ã‚’JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
      <button class="btn warn" id="wipeBtn">ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¨ãƒ‡ãƒ¼ã‚¿å‰Šé™¤</button>
    </div>
    <pre id="exportBox" style="margin-top:12px;white-space:pre-wrap;word-break:break-all;background:#0b1020;color:#e6ecff;border-radius:12px;padding:12px;display:none"></pre>
  </section>
</div>

<!-- Treasure Modal -->
<div class="modal-backdrop" id="modalBackdrop">
  <div class="modal">
    <div class="chest" id="chestEmoji">ğŸ§°</div>
    <h3 id="modalTitle">å®ç®±ãŒé–‹ã„ãŸï¼</h3>
    <p id="modalMessage">æ–°ã—ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’ã‚²ãƒƒãƒˆï¼</p>
    <img id="rewardImg" alt="new character" />
    <div style="margin-top:12px">
      <button class="btn secondary" id="closeModalBtn">ã¨ã˜ã‚‹</button>
    </div>
  </div>
</div>

<footer class="wrap">
  ãƒ’ãƒ³ãƒˆï¼šå˜å…ƒã¨å°å˜å…ƒã‚’é¸ã‚“ã§å…¨å•æ­£è§£ã‚’ç›®æŒ‡ãã†ã€‚å°å˜å…ƒã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ã¨é“ãŒ1ãƒã‚¹é€²ã¿ã€å®ç®±ã‹ã‚‰ã‚­ãƒ£ãƒ©ãŒå‡ºã‚‹ã‚ˆï¼
</footer>

<script>
/* ================= ã‚­ãƒ£ãƒ©ç”»åƒï¼ˆGoogle DriveåŸ‹ã‚è¾¼ã¿iframeãƒªãƒ³ã‚¯ï¼‰ ================ */
const allCharacters = [
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%81%82%E3%81%84%E3%81%95%E3%81%A4.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%A2%E3%82%B7%E3%83%9E%E3%83%AA01.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%A4%E3%83%BC%E3%83%95%E3%82%99%E3%82%A4.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%AB%E3%82%A4%E3%83%AA%E3%83%A5%E3%83%BC01.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%AB%E3%83%92%E3%82%99%E3%82%B3%E3%82%99%E3%83%B3.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%B1%E3%82%99%E3%83%B3%E3%82%AB%E3%82%99%E3%83%BC.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%B3%E3%82%A4%E3%82%AD%E3%83%B3%E3%82%AF%E3%82%9901.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%B3%E3%82%BF%E3%82%99%E3%83%83%E3%82%AF.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%B5%E3%83%AB%E3%83%8E%E3%83%AA01.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%B5%E3%83%B3%E3%82%BF%E3%82%99%E3%83%BC%E3%82%B9.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%B7%E3%83%A3%E3%83%AF%E3%83%BC%E3%82%B9%E3%82%9901.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%BB%E3%82%99%E3%83%8B%E3%82%AB%E3%82%99%E3%83%A1.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%82%BD%E3%83%BC%E3%83%8A%E3%83%B3%E3%82%B901.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%81%E3%82%A7%E3%83%AA%E3%83%A001.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%8A%E3%82%A8%E3%83%88%E3%83%AB.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%8B%E3%83%A3%E3%83%92%E3%82%99%E3%83%BC01.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%8B%E3%83%A3%E3%83%BC%E3%82%B901.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%92%E3%82%9A%E3%82%AB%E3%83%81%E3%83%A5%E3%82%A6.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%92%E3%82%9A%E3%82%AB%E3%83%81%E3%83%A5%E3%82%A6_%E7%A9%8D%E3%81%BF%E6%9C%A8.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%92%E3%82%9A%E3%82%AB%E3%83%81%E3%83%A5%E3%82%A6_%E9%9B%AA%E3%81%9F%E3%82%99%E3%82%8B%E3%81%BE.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%92%E3%82%9A%E3%82%AB%E3%83%81%E3%83%A5%E3%82%A6_%E9%A3%9F%E4%BA%8B%E4%B8%AD.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%92%E3%82%9A%E3%82%AB%E3%83%81%E3%83%A5%E3%82%A6%EF%BC%86%E3%83%92%E3%82%9A%E3%83%81%E3%83%A5%E3%83%BC.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%92%E3%82%9A%E3%83%81%E3%83%A5%E3%83%BC01.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%92%E3%82%B3%E3%82%B5%E3%82%99%E3%83%AB.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%92%E3%83%88%E3%82%AB%E3%82%B1%E3%82%99.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%92%E3%83%8E%E3%82%A2%E3%83%A9%E3%82%B7.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%95%E3%82%B7%E3%82%AD%E3%82%99%E3%82%BF%E3%82%99%E3%83%8D.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%9B%E3%82%9A%E3%83%83%E3%83%81%E3%83%A3%E3%83%9E.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%9F%E3%83%A5%E3%82%A6.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%9F%E3%83%A5%E3%82%A6%E3%83%84%E3%83%BC.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%A1%E3%82%BF%E3%83%A2%E3%83%B3.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%A1%E3%83%83%E3%82%BD%E3%83%B301.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%A2%E3%82%AF%E3%83%AD%E3%83%BC01.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%A4%E3%83%88%E3%82%99%E3%83%B301.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%A9%E3%82%A4%E3%83%81%E3%83%A5%E3%82%A601.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%A9%E3%83%83%E3%82%AD%E3%83%BC01.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%A9%E3%83%95%E3%82%9A%E3%83%A9%E3%82%B901.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%AA%E3%82%B5%E3%82%99%E3%83%BC%E3%83%88%E3%82%99%E3%83%B3.png",
  "https://raw.githubusercontent.com/knoriaki1995-star/20256/refs/heads/main/%E3%83%AD%E3%82%B3%E3%83%B301.png",
];

/* ================= å•é¡Œãƒ‡ãƒ¼ã‚¿ï¼ˆå…¨å°å˜å…ƒï¼‰ ================ */
const units = {
  "1-1 ç·šå¯¾ç§°": [
    { q: "ç·šå¯¾ç§°ã®å›³å½¢ã§ã€æ­£æ–¹å½¢ã®å¯¾ç§°ã®è»¸ã¯ä½•æœ¬ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", options: ["1","2","3","4"], answer: 4 },
    { q: "ç·šå¯¾ç§°ãªå›³å½¢ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ", options: ["S","N","A","F"], answer: 3 },
    { q: "ç·šå¯¾ç§°ã®å›³å½¢ã§ãªã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ", options: ["å††","äºŒç­‰è¾ºä¸‰è§’å½¢","é•·æ–¹å½¢","å°å½¢"], answer: 4 },
    { q: "ã²ã—å½¢ã®å¯¾ç§°ã®è»¸ã¯ä½•æœ¬ã§ã™ã‹ï¼Ÿ", options: ["1","2","3","4"], answer: 2 },
    { q: "ç·šå¯¾ç§°ã®å›³å½¢ã¯é¡ã«æ˜ ã™ã¨ã©ã†ãªã‚Šã¾ã™ã‹ï¼Ÿ", options: ["åŒã˜å½¢ã«ãªã‚‹","å½¢ãŒå¤‰ã‚ã‚‹","åè»¢ã—ã¦é•ã†å½¢ã«ãªã‚‹","å¤§ãããªã‚‹"], answer: 1 }
  ],
  "1-2 ç‚¹å¯¾ç§°": [
    { q: "ç‚¹å¯¾ç§°ãªå›³å½¢ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ", options: ["æ­£æ–¹å½¢","å††","é•·æ–¹å½¢","ã²ã—å½¢"], answer: 4 },
    { q: "ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã§ç‚¹å¯¾ç§°ãªæ–‡å­—ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ", options: ["A","B","C","H"], answer: 4 },
    { q: "ç‚¹å¯¾ç§°ãªå›³å½¢ã¯ã€180åº¦å›è»¢ã•ã›ã‚‹ã¨ã©ã†ãªã‚Šã¾ã™ã‹ï¼Ÿ", options: ["åŒã˜å½¢ã«ãªã‚‹","é€†ã•ã¾ã«ãªã‚‹ãŒå½¢ã¯åŒã˜","å…¨ãé•ã†å½¢ã«ãªã‚‹","å¤§ãããªã‚‹"], answer: 2 },
    { q: "ç‚¹å¯¾ç§°ã§ãªã„å›³å½¢ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ", options: ["å††","äº”è§’å½¢","é•·æ–¹å½¢","æ­£ä¸‰è§’å½¢"], answer: 4 },
    { q: "æ­£å…­è§’å½¢ã¯ç‚¹å¯¾ç§°ã§ã™ã‹ï¼Ÿ", options: ["ã¯ã„","ã„ã„ãˆ","å ´åˆã«ã‚ˆã‚‹","ã‚ã‹ã‚‰ãªã„"], answer: 1 }
  ],
  "2-1 æ–‡å­—ã‚’ä½¿ã£ãŸå¼ã®è¡¨ã—æ–¹": [
    { q: "xå€‹ã®ãƒªãƒ³ã‚´ãŒã‚ã‚Šã€1å€‹100å††ãªã‚‰ä»£é‡‘ã¯ï¼Ÿ", options: ["100x","x+100","100+x","x-100"], answer: 1 },
    { q: "ç¸¦xcmã€æ¨ªycmã®é•·æ–¹å½¢ã®é¢ç©ã¯ï¼Ÿ", options: ["x+y","xy","x-y","2x+2y"], answer: 2 },
    { q: "1å€‹aå††ã®ãŠè“å­ã‚’bå€‹è²·ã†ä»£é‡‘ã¯ï¼Ÿ", options: ["a+b","a-b","ab","a/b"], answer: 3 },
    { q: "måˆ†ã‚’ç§’ã«ã™ã‚‹ã¨ï¼Ÿ", options: ["60m","m/60","m+60","m-60"], answer: 1 },
    { q: "ç¸¦xã€æ¨ªyã®é•·æ–¹å½¢ã®å‘¨ã®é•·ã•ã¯ï¼Ÿ", options: ["x+y","2x+2y","xy","x-y"], answer: 2 }
  ],
  "2-2 æ–‡å­—ã‚’ä½¿ã£ãŸå¼ã®è¨ˆç®—": [
    { q: "3x+5xã¯ï¼Ÿ", options: ["8x","15x","x^8","2x"], answer: 1 },
    { q: "7x-2xã¯ï¼Ÿ", options: ["-5x","5x","x","7x"], answer: 2 },
    { q: "2x-1xã¯ï¼Ÿ", options: ["2x","x","3x","x/2"], answer: 2 },
    { q: "4x+2ã¯ï¼Ÿ", options: ["4x+2","x","8x","6x"], answer: 1 },
    { q: "5x+3yã¯ã“ã‚Œä»¥ä¸Šç°¡å˜ã«ã§ãã‚‹ï¼Ÿ", options: ["ã§ãã‚‹","ã§ããªã„","å ´åˆã«ã‚ˆã‚‹","ã‚ã‹ã‚‰ãªã„"], answer: 2 }
  ],
  "3-1 åˆ†æ•°Ã—æ•´æ•°": [
    { q: "3/4Ã—8ã¯ï¼Ÿ", options: ["6","8","9","10"], answer: 1 },
    { q: "2/5Ã—10ã¯ï¼Ÿ", options: ["2","4","6","8"], answer: 2 },
    { q: "7/8Ã—16ã¯ï¼Ÿ", options: ["10","12","14","16"], answer: 3 },
    { q: "5/6Ã—12ã¯ï¼Ÿ", options: ["4","6","8","10"], answer: 4 },
    { q: "4/9Ã—27ã¯ï¼Ÿ", options: ["10","12","14","16"], answer: 2 }
  ],
  "3-2 åˆ†æ•°Ã·æ•´æ•°": [
    { q: "3/4Ã·2ã¯ï¼Ÿ", options: ["3/8","3/6","3/2","6/4"], answer: 1 },
    { q: "5/6Ã·5ã¯ï¼Ÿ", options: ["1/6","5/30","5/11","6/5"], answer: 1 },
    { q: "7/8Ã·7ã¯ï¼Ÿ", options: ["1/8","7/15","1/16","15/7"], answer: 3 },
    { q: "2/3Ã·4ã¯ï¼Ÿ", options: ["2/12","1/6","2/7","3/8"], answer: 2 },
    { q: "9/10Ã·3ã¯ï¼Ÿ", options: ["10/27","3/13","1/3","3/10"], answer: 4 }
  ],
  "3-3 åˆ†æ•°Ã—åˆ†æ•°": [
    { q: "2/3Ã—3/4ã¯ï¼Ÿ", options: ["1/2","2/7","3/8","1/3"], answer: 1 },
    { q: "5/6Ã—2/5ã¯ï¼Ÿ", options: ["1/6","2/3","5/12","1/3"], answer: 4 },
    { q: "7/8Ã—4/7ã¯ï¼Ÿ", options: ["4/8","1/2","1/3","2/7"], answer: 2 },
    { q: "3/5Ã—5/9ã¯ï¼Ÿ", options: ["5/15","1/2","1/3","3/14"], answer: 3 },
    { q: "4/7Ã—14/5ã¯ï¼Ÿ", options: ["8/5","4/5","2/7","7/8"], answer: 1 }
  ],
  "4-1 åˆ†æ•°Ã·åˆ†æ•°": [
    { q: "2/3Ã·4/5ã¯ï¼Ÿ", options: ["5/3","6/5","3/5","5/6"], answer: 4 },
    { q: "3/4Ã·2/7ã¯ï¼Ÿ", options: ["7/8","8/21","21/8","3/14"], answer: 3 },
    { q: "5/6Ã·5/12ã¯ï¼Ÿ", options: ["1/2","2","5/10","12/5"], answer: 2 },
    { q: "7/8Ã·1/4ã¯ï¼Ÿ", options: ["7/2","8/7","7/32","1/2"], answer: 1 },
    { q: "9/10Ã·3/5ã¯ï¼Ÿ", options: ["3/2","2/3","5/6","10/27"], answer: 1 }
  ],
  "4-2 åˆ†æ•°ã®å€": [
    { q: "3/4ã®2å€ã¯ï¼Ÿ", options: ["1/2","6/4","3/2","4/3"], answer: 3 },
    { q: "5/6ã®3å€ã¯ï¼Ÿ", options: ["6/5","5/2","3/5","15/6"], answer: 4 },
    { q: "2/5ã®4å€ã¯ï¼Ÿ", options: ["8/5","5/8","4/5","2/8"], answer: 1 },
    { q: "7/8ã®0.5å€ã¯ï¼Ÿ", options: ["14/8","16/7","1/2","7/16"], answer: 4 },
    { q: "9/10ã®1.5å€ã¯ï¼Ÿ", options: ["27/20","20/27","3/5","5/3"], answer: 1 }
  ],
  "5-1 æ¯”ã®æ„å‘³": [
    { q: "3:4ã¯æ¬¡ã®ã©ã‚Œã¨ç­‰ã—ã„ã§ã™ã‹ï¼Ÿ", options: ["4:5","6:8","9:10","12:13"], answer: 2 },
    { q: "2:5ã¨ç­‰ã—ã„æ¯”ã¯ï¼Ÿ", options: ["4:10","5:12","3:5","7:9"], answer: 1 },
    { q: "5:8ã¨ç­‰ã—ã„æ¯”ã¯ï¼Ÿ", options: ["10:16","8:13","15:24","1:2"], answer: 1 },
    { q: "1:3ã¨ç­‰ã—ã„æ¯”ã¯ï¼Ÿ", options: ["2:6","3:9","4:12","å…¨éƒ¨"], answer: 4 },
    { q: "6:9ã‚’ç°¡å˜ã«ã™ã‚‹ã¨ï¼Ÿ", options: ["3:4","2:3","4:5","3:5"], answer: 2 }
  ],
  "5-2 æ¯”ã®å€¤ã®è¨ˆç®—": [
    { q: "8:12ã®å€¤ã¯ï¼Ÿ", options: ["4/6","3/2","2/3","6/4"], answer: 3 },
    { q: "5:20ã®å€¤ã¯ï¼Ÿ", options: ["5","4","1/4","20"], answer: 3 },
    { q: "9:15ã®å€¤ã¯ï¼Ÿ", options: ["5/3","3/5","2/3","1/2"], answer: 2 },
    { q: "7:14ã®å€¤ã¯ï¼Ÿ", options: ["14/7","2","7/14","1/2"], answer: 4 },
    { q: "12:18ã®å€¤ã¯ï¼Ÿ", options: ["6/4","3/2","4/6","2/3"], answer: 4 }
  ],
  "5-3 æ¯”ã®åˆ©ç”¨": [
    { q: "3:5ã®æ¯”ã§8å€‹ã®ãƒœãƒ¼ãƒ«ã‚’åˆ†ã‘ã¾ã™ã€‚å°‘ãªã„æ–¹ã¯ä½•å€‹ã§ã™ã‹ï¼Ÿ", options: ["3","4","5","8"], answer: 2 },
    { q: "2:3ã®æ¯”ã§20å€‹ã®é£´ã‚’åˆ†ã‘ã¾ã™ã€‚å¤šã„æ–¹ã¯ä½•å€‹ã§ã™ã‹ï¼Ÿ", options: ["8","10","12","15"], answer: 3 },
    { q: "4:1ã®æ¯”ã§10Lã®ã‚¸ãƒ¥ãƒ¼ã‚¹ã‚’åˆ†ã‘ã¾ã™ã€‚å°‘ãªã„æ–¹ã¯ä½•Lã§ã™ã‹ï¼Ÿ", options: ["2","4","6","8"], answer: 1 },
    { q: "5:7ã®æ¯”ã§24mã®ãƒªãƒœãƒ³ã‚’åˆ†ã‘ã¾ã™ã€‚å¤šã„æ–¹ã¯ä½•mã§ã™ã‹ï¼Ÿ", options: ["10","12","14","16"], answer: 3 },
    { q: "1:4ã®æ¯”ã§25æšã®ã‚«ãƒ¼ãƒ‰ã‚’åˆ†ã‘ã¾ã™ã€‚å¤šã„æ–¹ã¯ä½•æšã§ã™ã‹ï¼Ÿ", options: ["4","5","20","25"], answer: 3 }
  ],
  "6-1 æ‹¡å¤§å›³": [
    { q: "é•·ã•4cmã®ç·šåˆ†ã‚’ã€2å€ã«æ‹¡å¤§ã™ã‚‹ã¨é•·ã•ã¯ä½•cmã«ãªã‚Šã¾ã™ã‹ï¼Ÿ", options: ["6","8","10","12"], answer: 2 },
    { q: "ä¸‰è§’å½¢ã®å„è¾ºã®é•·ã•ãŒ2cm, 3cm, 4cmã®ã¨ãã€1.5å€ã«æ‹¡å¤§ã—ãŸä¸‰è§’å½¢ã®æœ€ã‚‚é•·ã„è¾ºã¯ä½•cmã§ã™ã‹ï¼Ÿ", options: ["5","5.5","6","6.5"], answer: 3 },
    { q: "æ­£æ–¹å½¢ã®ä¸€è¾ºãŒ5cmã®å›³å½¢ã‚’ã€3å€ã«æ‹¡å¤§ã—ãŸã¨ãã®ä¸€è¾ºã®é•·ã•ã¯ä½•cmã§ã™ã‹ï¼Ÿ", options: ["10","12","15","20"], answer: 3 },
    { q: "åŠå¾„3cmã®å††ã‚’2å€ã«æ‹¡å¤§ã—ãŸã¨ãã®åŠå¾„ã¯ä½•cmã§ã™ã‹ï¼Ÿ", options: ["5","6","7","8"], answer: 4 },
    { q: "é•·ã•9cmã®ç·šåˆ†ã‚’ã€0.5å€ã«ç¸®å°ã™ã‚‹ã¨é•·ã•ã¯ä½•cmã«ãªã‚Šã¾ã™ã‹ï¼Ÿ", options: ["4.5","5","6","7"], answer: 1 }
  ],
  "6-2 ç¸®å›³": [
    { q: "å®Ÿéš›ã®é•·ã•20mã‚’ã€1/100ã®ç¸®å°ºã§è¡¨ã™ã¨ä½•cmã«ãªã‚Šã¾ã™ã‹ï¼Ÿ", options: ["20","200","2","0.2"], answer: 2 },
    { q: "åœ°å›³ä¸Šã§5cmã®è·é›¢ãŒã€å®Ÿéš›ã«ã¯1kmã®ã¨ãã®ç¸®å°ºã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ", options: ["1/20000","1/50000","1/10000","1/25000"], answer: 2 },
    { q: "å®Ÿéš›ã®è·é›¢300mã‚’ã€1/500ã®ç¸®å°ºã§è¡¨ã™ã¨å›³ä¸Šã§ã¯ä½•cmã«ãªã‚Šã¾ã™ã‹ï¼Ÿ", options: ["60","6","0.6","600"], answer: 1 },
    { q: "åœ°å›³ä¸Šã§12cmã®è·é›¢ãŒã€å®Ÿéš›ã«ã¯480mã§ã‚ã‚‹ã¨ãã€ç¸®å°ºã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ", options: ["1/40","1/400","1/4000","1/4800"], answer: 3 },
    { q: "å®Ÿéš›ã®é•·ã•8mã‚’1/200ã®ç¸®å°ºã§æãã¨ã€å›³ã®é•·ã•ã¯ä½•cmã«ãªã‚Šã¾ã™ã‹ï¼Ÿ", options: ["40","4","0.4","400"], answer: 4 }
  ],
  "7-1å¹³å‡å€¤ã¨ä¸­å¤®å€¤": [
    { q: "5, 8, 10 ã®å¹³å‡å€¤ã¯ï¼Ÿ", options: ["7","8","9","10"], answer: 1 },
    { q: "3, 5, 7 ã®ä¸­å¤®å€¤ã¯ï¼Ÿ", options: ["3","5","7","6"], answer: 2 },
    { q: "4, 6, 8, 10 ã®å¹³å‡å€¤ã¯ï¼Ÿ", options: ["7","8","6","9"], answer: 1 },
    { q: "1, 3, 5, 7, 9 ã®ä¸­å¤®å€¤ã¯ï¼Ÿ", options: ["3","5","7","4"], answer: 2 },
    { q: "2, 4, 6, 8 ã®ä¸­å¤®å€¤ã¯ï¼Ÿ", options: ["4","5","6","7"], answer: 2 }
  ],
  "7-2åº¦æ•°åˆ†å¸ƒè¡¨ã¨æŸ±çŠ¶ã‚°ãƒ©ãƒ•": [
    { q: "åº¦æ•°åˆ†å¸ƒè¡¨ã§æœ€ã‚‚å¤šã„åŒºé–“ã‚’ä½•ã¨å‘¼ã¶ï¼Ÿ", options: ["å¹³å‡","æœ€é »å€¤","ä¸­å¤®å€¤","ç¯„å›²"], answer: 2 },
    { q: "æŸ±çŠ¶ã‚°ãƒ©ãƒ•ã¯ã©ã‚“ãªãƒ‡ãƒ¼ã‚¿ã«å‘ã„ã¦ã„ã‚‹ï¼Ÿ", options: ["æ™‚é–“ã®å¤‰åŒ–","å‰²åˆã®æ¯”è¼ƒ","æ•°å€¤ã®åˆ†å¸ƒ","ä½ç½®ã®å¤‰åŒ–"], answer: 3 },
    { q: "åº¦æ•°åˆ†å¸ƒè¡¨ã§éšç´šã®å¹…ãŒå¤§ãã„ã»ã©ï¼Ÿ", options: ["ç´°ã‹ãè¦‹ãˆã‚‹","å¤§ã¾ã‹ã«ãªã‚‹","å¤‰ã‚ã‚‰ãªã„","ä¸æ˜"], answer: 2 },
    { q: "æŸ±çŠ¶ã‚°ãƒ©ãƒ•ã®ç¸¦è»¸ã¯ä½•ã‚’è¡¨ã™ï¼Ÿ", options: ["åº¦æ•°","å‰²åˆ","æ™‚é–“","éšç´š"], answer: 1 },
    { q: "å¸¯ã‚°ãƒ©ãƒ•ã¯ä½•ã‚’è¡¨ã™ã®ã«ä¾¿åˆ©ï¼Ÿ", options: ["é †åº","å‰²åˆ","ä½ç½®","æ™‚é–“"], answer: 4 }
  ],
  "7-3æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã¨å¸¯ã‚°ãƒ©ãƒ•": [
    { q: "æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã¯ä½•ã‚’è¡¨ã™ï¼Ÿ", options: ["åˆ†å¸ƒ","å‰²åˆã®æ¯”è¼ƒ","æ™‚é–“ã®å¤‰åŒ–","é †åº"], answer: 3 },
    { q: "å¸¯ã‚°ãƒ©ãƒ•ã®å…¨ä½“ã®é•·ã•ã¯ä½•ã‚’è¡¨ã™ï¼Ÿ", options: ["100%","åˆè¨ˆ","æœ€å¤§å€¤","ä¸­å¤®å€¤"], answer: 1 },
    { q: "æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã§ç‚¹ã‚’çµã¶ç·šã¯ä½•ã‚’ç¤ºã™ï¼Ÿ", options: ["å‰²åˆ","å¤‰åŒ–ã®æ§˜å­","å¹³å‡","ç¯„å›²"], answer: 2 },
    { q: "å¸¯ã‚°ãƒ©ãƒ•ã§è‰²åˆ†ã‘ã•ã‚Œã¦ã„ã‚‹éƒ¨åˆ†ã¯ä½•ã‚’è¡¨ã™ï¼Ÿ", options: ["æ™‚é–“ã®å¤‰åŒ–","é …ç›®åˆ¥ã®å‰²åˆ","å¹³å‡","éšç´š"], answer: 2 },
    { q: "æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã¨æŸ±çŠ¶ã‚°ãƒ©ãƒ•ã‚’çµ„ã¿åˆã‚ã›ãŸã‚‚ã®ã¯ï¼Ÿ", options: ["ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ","å¸¯ã‚°ãƒ©ãƒ•","æ•£å¸ƒå›³","è¤‡åˆã‚°ãƒ©ãƒ•"], answer: 4 }
  ],
  "8-1å††ã®é¢ç©ã®æ±‚ã‚æ–¹": [
    { q: "åŠå¾„5cmã®å††ã®é¢ç©ã¯ï¼Ÿ", options: ["31.4","78.5","25","62.8"], answer: 2 },
    { q: "åŠå¾„10cmã®å††ã®é¢ç©ã¯ï¼Ÿ", options: ["157","314","100","62.8"], answer: 2 },
    { q: "ç›´å¾„8cmã®å††ã®åŠå¾„ã¯ï¼Ÿ", options: ["16","8","4","2"], answer: 3 },
    { q: "å††ã®é¢ç©ã®å…¬å¼ã¯ï¼Ÿ", options: ["åŠå¾„Ã—3.14","ç›´å¾„Ã—ç›´å¾„Ã—3.14","ç›´å¾„Ã—3.14","åŠå¾„Ã—åŠå¾„Ã—3.14"], answer: 4 },
    { q: "åŠå¾„3cmã®å††ã®é¢ç©ã¯ï¼Ÿ", options: ["28.26","18.84","9","31.4"], answer: 1 }
  ],
  "8-2åŠå††ãƒ»æ‰‡å½¢ã®é¢ç©": [
    { q: "åŠå¾„6cmã®åŠå††ã®é¢ç©ã¯ï¼Ÿ", options: ["56.52","113.04","18.84","28.26"], answer: 1 },
    { q: "åŠå¾„4cmã€ä¸­å¿ƒè§’90Â°ã®æ‰‡å½¢ã®é¢ç©ã¯ï¼Ÿ", options: ["12.56","25.12","50.24","6.28"], answer: 1 },
    { q: "åŠå¾„5cmã€ä¸­å¿ƒè§’180Â°ã®æ‰‡å½¢ã¯ä½•ã®å½¢ã®åŠåˆ†ï¼Ÿ", options: ["å††","é•·æ–¹å½¢","ä¸‰è§’å½¢","æ¥•å††"], answer: 1 },
    { q: "åŠå††ã®é¢ç©ã‚’æ±‚ã‚ã‚‹ã«ã¯å††ã®é¢ç©ã‚’ã©ã†ã™ã‚‹ï¼Ÿ", options: ["2å€","åŠåˆ†","3å€","4å€"], answer: 2 },
  ],
  "9-1è§’æŸ±ã®ä½“ç©": [
    { q: "åº•é¢ç©20cmÂ²ã€é«˜ã•5cmã®è§’æŸ±ã®ä½“ç©ã¯ï¼Ÿ", options: ["10","25","200","100"], answer: 4 },
    { q: "åº•é¢ãŒé•·æ–¹å½¢ã®è§’æŸ±ã®ä½“ç©ã¯åº•é¢ç©Ã—ä½•ï¼Ÿ", options: ["åº•è¾º","é«˜ã•","å¹…","å¥¥è¡Œã"], answer: 2 },
    { q: "åº•é¢ç©50cmÂ²ã€é«˜ã•2cmã®è§’æŸ±ã®ä½“ç©ã¯ï¼Ÿ", options: ["150","25","100","200"], answer: 3 },
    { q: "ä½“ç©ã®å˜ä½ã¯ï¼Ÿ", options: ["cmÂ²","cmÂ³","cm","m"], answer: 2 },
    { q: "åº•é¢ç©10cmÂ²ã€é«˜ã•10cmã®è§’æŸ±ã®ä½“ç©ã¯ï¼Ÿ", options: ["100","10","1","1000"], answer: 1 }
  ],
  "9-2å††æŸ±ã®ä½“ç©": [
    { q: "åº•é¢ç©30cmÂ²ã€é«˜ã•5cmã®å††æŸ±ã®ä½“ç©ã¯ï¼Ÿ", options: ["15","35","300","150"], answer: 4 },
    { q: "å††æŸ±ã®ä½“ç©ã®å…¬å¼ã¯ï¼Ÿ", options: ["åº•é¢ç©Ã—é«˜ã•","åŠå¾„Ã—åŠå¾„Ã—3.14","ç›´å¾„Ã—é«˜ã•","é«˜ã•Ã—å‘¨ã®é•·ã•"], answer: 1 },
    { q: "åŠå¾„3cmã€é«˜ã•10cmã®å††æŸ±ã®ä½“ç©ã¯ï¼Ÿ(Ï€=3.14)", options: ["282.6","94.2","188.4","565.2"], answer: 1 },
    { q: "ä½“ç©ã®å˜ä½ã¯ï¼Ÿ", options: ["cmÂ²","cmÂ³","cm","mÂ²"], answer: 2 },
    { q: "åº•é¢ç©15cmÂ²ã€é«˜ã•4cmã®å††æŸ±ã®ä½“ç©ã¯ï¼Ÿ", options: ["60","45","30","75"], answer: 1 }
  ],
  "10-1é¢ç©ã®ãŠã‚ˆãã®å€¤": [
    { q: "é•·æ–¹å½¢ã®é¢ç©ã‚’ãŠã‚ˆãæ±‚ã‚ã‚‹ã¨ãã€1è¾ºãŒ2.9mãªã‚‰ä½•mã¨ã—ã¦è¨ˆç®—ã™ã‚‹ï¼Ÿ", options: ["2m","1m","4m","3m"], answer: 4 },
    { q: "åŠå¾„3.2cmã®å††ã®é¢ç©ã‚’ãŠã‚ˆãæ±‚ã‚ã‚‹ã«ã¯åŠå¾„ã‚’ä½•cmã¨ã™ã‚‹ï¼Ÿ", options: ["2cm","3.5cm","4cm","3cm"], answer: 4 },
    { q: "1.48mã‚’ãŠã‚ˆãã®å€¤ã«ã™ã‚‹ã¨ï¼Ÿ", options: ["1m","1.5m","2m","1.4m"], answer: 2 },
    { q: "1.76mã‚’å››æ¨äº”å…¥ã—ã¦æ•´æ•°ã«ã™ã‚‹ã¨ï¼Ÿ", options: ["1m","2m","3m","1.5m"], answer: 2 },
    { q: "3.14ã‚’ãŠã‚ˆã3ã¨ã™ã‚‹ã®ã¯ã©ã‚“ãªã¨ãï¼Ÿ", options: ["é¢ç©ã‚’å‡ºã™ã¨ã","æ­£ç¢ºãªè¨ˆç®—ã®ã¨ã","æ¦‚ç®—ã®ã¨ã","èª¤å·®ã‚’å‡ºã™ã¨ã"], answer: 3 }
  ],
  "10-2ä½“ç©ã®ãŠã‚ˆãã®å€¤": [
    { q: "é«˜ã•ãŒ4.9mã®å††æŸ±ã®ä½“ç©ã‚’ãŠã‚ˆãæ±‚ã‚ã‚‹ã¨ãã€é«˜ã•ã‚’ä½•mã¨ã™ã‚‹ï¼Ÿ", options: ["4m","4.5m","6m","5m"], answer: 4 },
    { q: "åŠå¾„2.6mã®å††æŸ±ã®ä½“ç©ã‚’ãŠã‚ˆãæ±‚ã‚ã‚‹ã¨ãã€åŠå¾„ã‚’ä½•mã¨ã™ã‚‹ï¼Ÿ", options: ["2m","3m","2.5m","2.8m"], answer: 2 },
    { q: "6.4mã‚’å››æ¨äº”å…¥ã—ã¦æ•´æ•°ã«ã™ã‚‹ã¨ï¼Ÿ", options: ["6m","7m","5m","8m"], answer: 2 },
    { q: "3.2mã‚’ãŠã‚ˆãã®å€¤ã«ã™ã‚‹ã¨ï¼Ÿ", options: ["3.5m","4m","2m","3m"], answer: 4 },
    { q: "ä½“ç©ã®æ¦‚ç®—ã‚’ã™ã‚‹ç†ç”±ã¯ï¼Ÿ", options: ["è¨ˆç®—ã‚’ç°¡å˜ã«ã™ã‚‹ãŸã‚","æ­£ç¢ºã«ã™ã‚‹ãŸã‚","æ¸¬å®šã®ãŸã‚","å®Ÿé¨“ã®ãŸã‚"], answer: 1 }
  ],
  "11-1æ¯”ä¾‹ã®æ„å‘³ã¨ã‚°ãƒ©ãƒ•": [
    { q: "æ¯”ä¾‹ã®å¼ã¯ y=â–¡x ã§è¡¨ã•ã‚Œã‚‹ã€‚â–¡ã«å…¥ã‚‹ã®ã¯ï¼Ÿ", options: ["é€Ÿåº¦","å‰²åˆ","æ¯”ä¾‹å®šæ•°","æ¯”"], answer: 3 },
    { q: "xãŒ2å€ã«ãªã‚‹ã¨yã‚‚2å€ã«ãªã‚‹ã®ã¯ï¼Ÿ", options: ["ç­‰å·®æ•°åˆ—","åæ¯”ä¾‹","æ¯”ä¾‹","æ¯”ä¾‹åæ¯”ä¾‹"], answer: 3 },
    { q: "æ¯”ä¾‹ã®ã‚°ãƒ©ãƒ•ã¯ã©ã‚“ãªå½¢ï¼Ÿ", options: ["ç›´ç·š","æ›²ç·š","æŠ˜ã‚Œç·š","æ”¾ç‰©ç·š"], answer: 1 },
    { q: "æ¯”ä¾‹ã®ã‚°ãƒ©ãƒ•ã¯åŸç‚¹ã‚’é€šã‚‹ï¼Ÿ", options: ["é€šã‚‹","é€šã‚‰ãªã„","å ´åˆã«ã‚ˆã‚‹","ã‚ã‹ã‚‰ãªã„"], answer: 1 },
    { q: "y=3xã®ã¨ãã€x=4ãªã‚‰yã¯ï¼Ÿ", options: ["3","7","8","12"], answer: 4 }
  ],
  "11-2åæ¯”ä¾‹ã®æ„å‘³ã¨ã‚°ãƒ©ãƒ•": [
    { q: "åæ¯”ä¾‹ã®å¼ã¯ xy=â–¡ ã§è¡¨ã•ã‚Œã‚‹ã€‚â–¡ã«å…¥ã‚‹ã®ã¯ï¼Ÿ", options: ["é€Ÿåº¦","å‰²åˆ","å®šæ•°","æ¯”"], answer: 3 },
    { q: "xãŒ2å€ã«ãªã‚‹ã¨yã¯ï¼Ÿ", options: ["åŠåˆ†ã«ãªã‚‹","2å€ã«ãªã‚‹","å¤‰ã‚ã‚‰ãªã„","4å€ã«ãªã‚‹"], answer: 1 },
    { q: "åæ¯”ä¾‹ã®ã‚°ãƒ©ãƒ•ã¯ã©ã‚“ãªå½¢ï¼Ÿ", options: ["å††","ç›´ç·š","æ”¾ç‰©ç·š","åŒæ›²ç·š"], answer: 4 },
    { q: "y=12/x ã®ã¨ãã€x=3ãªã‚‰yã¯ï¼Ÿ", options: ["4","3","12","6"], answer: 1 },
    { q: "åæ¯”ä¾‹ã®ã‚°ãƒ©ãƒ•ã¯åŸç‚¹ã‚’é€šã‚‹ï¼Ÿ", options: ["é€šã‚‹","é€šã‚‰ãªã„","å ´åˆã«ã‚ˆã‚‹","ã‚ã‹ã‚‰ãªã„"], answer: 2 }
  ],
  "12-1é †åˆ—ï¼ˆä¸¦ã¹æ–¹ï¼‰": [
    { q: "3äººã‚’ä¸¦ã¹ã‚‹é †åˆ—ã¯ä½•é€šã‚Šï¼Ÿ", options: ["3","6","9","12"], answer: 2 },
    { q: "4äººã®é †åˆ—ã¯ä½•é€šã‚Šï¼Ÿ", options: ["8","12","26","24"], answer: 4 },
    { q: "é †åˆ—ã§é †ç•ªã‚’å…¥ã‚Œæ›¿ãˆã‚‹ã¨åˆ¥ã®ä¸¦ã³ã¨ã¿ãªã™ï¼Ÿ", options: ["ã¯ã„","ã„ã„ãˆ","å ´åˆã«ã‚ˆã‚‹","ã‚ã‹ã‚‰ãªã„"], answer: 1 },
    { q: "4äººã‹ã‚‰3äººã‚’ä¸¦ã¹ã‚‹ã®ã¯ä½•é€šã‚Šï¼Ÿ", options: ["10","16","20","24"], answer: 4 }
  ],
  "12-2çµ„ã¿åˆã‚ã›": [
    { q: "5äººã‹ã‚‰2äººã‚’é¸ã¶çµ„ã¿åˆã‚ã›ã¯ä½•é€šã‚Šï¼Ÿ", options: ["20","10","5","15"], answer: 2 },
    { q: "çµ„ã¿åˆã‚ã›ã¯é †ç•ªã‚’è€ƒãˆã‚‹ï¼Ÿ", options: ["è€ƒãˆãªã„","è€ƒãˆã‚‹","å ´åˆã«ã‚ˆã‚‹","ã‚ã‹ã‚‰ãªã„"], answer: 1 },
    { q: "4äººã‹ã‚‰3äººã‚’é¸ã¶çµ„ã¿åˆã‚ã›ã¯ä½•é€šã‚Šï¼Ÿ", options: ["4","12","6","3"], answer: 3 },
    { q: "6äººã‹ã‚‰2äººã‚’é¸ã¶çµ„ã¿åˆã‚ã›ã¯ä½•é€šã‚Šï¼Ÿ", options: ["12","20","10","15"], answer: 4 }
  ],
  "13-1ç·åˆå•é¡Œï¼ˆå‰åŠï¼‰": [
    { q: "5Ã—(2+3)ã®è¨ˆç®—çµæœã¯ï¼Ÿ", options: ["25","20","10","15"], answer: 1 },
    { q: "1/2Ã—1/4ã¯ï¼Ÿ", options: ["1/6","1/8","1/4","1/2"], answer: 2 },
    { q: "3:4ã®æ¯”ã‚’åˆ†æ•°ã§è¡¨ã™ã¨ï¼Ÿ", options: ["3/4","4/3","7","1"], answer: 1 },
    { q: "å††ã®é¢ç©å…¬å¼ã¯ï¼Ÿ", options: ["åŠå¾„Ã—3.14","ç›´å¾„Ã—3.14","åŠå¾„Ã—åŠå¾„Ã—3.14","åŠå¾„Ã—åŠå¾„"], answer: 3 },
    { q: "åº•è¾º10cmã€é«˜ã•5cmã®ä¸‰è§’å½¢ã®é¢ç©ã¯ï¼Ÿ", options: ["50","25","20","15"], answer: 2 }
  ],
  "13-2ç·åˆå•é¡Œï¼ˆå¾ŒåŠï¼‰": [
    { q: "åæ¯”ä¾‹ã®ã‚°ãƒ©ãƒ•ã®å½¢ã¯ï¼Ÿ", options: ["ç›´ç·š","æ”¾ç‰©ç·š","åŒæ›²ç·š","å††"], answer: 3 },
    { q: "3äººã‹ã‚‰2äººã‚’é¸ã¶çµ„ã¿åˆã‚ã›ã¯ï¼Ÿ", options: ["6","3","9","2"], answer: 2 },
    { q: "2.8mã‚’å››æ¨äº”å…¥ã—ã¦æ•´æ•°ã«ã™ã‚‹ã¨ï¼Ÿ", options: ["3","2","4","5"], answer: 1 },
    { q: "y=5xã®ã¨ãx=2ãªã‚‰yã¯ï¼Ÿ", options: ["7","8","12","10"], answer: 4 },
    { q: "åŠå¾„7cmã®å††å‘¨ã®é•·ã•ã¯ï¼Ÿ(Ï€=3.14)", options: ["43.96","49","21.98","50"], answer: 1 }
  ]
};

/* ================== å®šæ•°ãƒ»ã‚­ãƒ¼ ================== */
const teacherPassword = "sensei";
const VERSION = "adventure_v1";
let currentUser = null;

/* ================== localStorage ãƒ˜ãƒ«ãƒ‘ ================== */
function keyUser(){ return `${VERSION}::user`; }
function keySubProgress(sub){ return `${VERSION}::${currentUser}::sub::${sub}`; } // { correct:[], cursor:number, awarded:boolean }
function keyCollection(){ return `${VERSION}::${currentUser}::collection`; }
function keyClearedCount(){ return `${VERSION}::${currentUser}::clearedCount`; } // ã‚¯ãƒªã‚¢æ¸ˆã¿å°å˜å…ƒæ•°ï¼ˆé“ã®æ­©æ•°ï¼‰

function saveUser(name){ localStorage.setItem(keyUser(), name); }
function loadUser(){ return localStorage.getItem(keyUser()); }

function getProgress(sub){
  const raw = localStorage.getItem(keySubProgress(sub));
  if(!raw) return { correct:[], cursor:0, awarded:false };
  try{ const o = JSON.parse(raw); return { correct:o.correct||[], cursor:o.cursor||0, awarded:!!o.awarded }; }
  catch{ return { correct:[], cursor:0, awarded:false }; }
}
function setProgress(sub, obj){
  localStorage.setItem(keySubProgress(sub), JSON.stringify(obj));
}

function getCollection(){
  try{ return JSON.parse(localStorage.getItem(keyCollection())||"[]"); }catch{return []}
}
function setCollection(arr){ localStorage.setItem(keyCollection(), JSON.stringify(arr)); }

function getClearedCount(){
  const n = Number(localStorage.getItem(keyClearedCount())||"0");
  return isNaN(n)?0:n;
}
function setClearedCount(n){ localStorage.setItem(keyClearedCount(), String(n)); }

/* ================== å ±é…¬ï¼ˆè¢«ã‚Šã‚ã‚Šã§ãƒ©ãƒ³ãƒ€ãƒ ï¼‰ ================== */
function awardRandomCharacter(){
  const col = getCollection();
  const url = allCharacters[Math.floor(Math.random()*allCharacters.length)];
  col.push(url); // è¢«ã‚Šã‚ã‚Š
  setCollection(col);
  return url;
}

/* ================== UIè¦ç´  ================== */
const loginCard = document.getElementById('loginCard');
const adventureCard = document.getElementById('adventureCard');
const quizCard = document.getElementById('quizCard');
const collectionCard = document.getElementById('collectionCard');
const teacherCard = document.getElementById('teacherCard');

const currentUserLabel = document.getElementById('currentUserLabel');
const qCounter = document.getElementById('qCounter');
const subunitTitle = document.getElementById('subunitTitle');
const questionText = document.getElementById('questionText');
const optionsDiv = document.getElementById('options');
const feedback = document.getElementById('feedback');
const progressText = document.getElementById('progressText');
const progressBar = document.getElementById('progressBar');

const pathDiv = document.getElementById('path');
const hero = document.getElementById('hero');
const clearedCountLabel = document.getElementById('clearedCount');
const totalSubunitsLabel = document.getElementById('totalSubunits');

/* ================== ã‚»ãƒ¬ã‚¯ãƒˆç”Ÿæˆ ================== */
const unitSelect = document.createElement('select');
const subunitSelect = document.createElement('select');
unitSelect.id = "unitSelect";
subunitSelect.id = "subunitSelect";

const quizHeaderControls = document.createElement('div');
quizHeaderControls.className = "row";
quizHeaderControls.style.margin = "0 0 8px";
quizHeaderControls.innerHTML = `
  <div style="flex:1">
    <label class="small muted">å˜å…ƒ</label>
  </div>
  <div style="flex:1">
    <label class="small muted">å°å˜å…ƒ</label>
  </div>
`;
quizHeaderControls.children[0].appendChild(unitSelect);
quizHeaderControls.children[1].appendChild(subunitSelect);
quizCard.insertBefore(quizHeaderControls, quizCard.children[1]);

/* ================== å†’é™ºãƒ‘ã‚¹æ§‹ç¯‰ ================== */
function buildUnitMap(){
  const map = {};
  Object.keys(units).forEach(key=>{
    const unitNo = (key.split('-')[0]||"").trim();
    map[unitNo] = map[unitNo] || [];
    map[unitNo].push(key);
  });
  Object.keys(map).forEach(no=> map[no].sort((a,b)=> a.localeCompare(b,'ja')));
  return map;
}
const unitMap = buildUnitMap();
const subunitsOrdered = Object.keys(unitMap).sort((a,b)=>Number(a)-Number(b))
  .flatMap(no => unitMap[no]);

/* ================== å†’é™ºãƒ‘ã‚¹æç”» ================== */
function renderAdventurePath(){
  const total = subunitsOrdered.length;
  totalSubunitsLabel.textContent = total;
  pathDiv.innerHTML = "";
  // ãƒãƒ¼ãƒ‰ç”Ÿæˆï¼ˆå°å˜å…ƒæ•°åˆ†ï¼‰
  subunitsOrdered.forEach((name, idx)=>{
    const node = document.createElement('div');
    node.className = 'node';
    node.dataset.sub = name;
    // å˜å…ƒã®æœ€åˆãƒãƒ¼ãƒ‰ã«ãƒ©ãƒ™ãƒ«
    const isHead = unitMap[name.split('-')[0]].indexOf(name)===0;
    if(isHead){
      const label = document.createElement('div');
      label.className = 'label';
      label.textContent = `å˜å…ƒ ${name.split('-')[0]}`;
      node.appendChild(label);
    }
    // ã‚¯ãƒªã‚¢æ¸ˆã¿è¡¨ç¤º
    const pr = getProgress(name);
    if(pr.awarded) node.classList.add('done','treasure');
    pathDiv.appendChild(node);
  });
  updateHeroPosition(false);
}

/* ================== ãƒ’ãƒ¼ãƒ­ãƒ¼ã®ä½ç½®æ›´æ–° ================== */
function updateHeroPosition(animate=true){
  const cleared = subunitsOrdered.filter(s => getProgress(s).awarded).length;
  const total = subunitsOrdered.length;
  clearedCountLabel.textContent = cleared;
  const nodes = [...pathDiv.children];
  nodes.forEach((n,i)=> n.classList.toggle('done', getProgress(n.dataset.sub).awarded));

  // left%ï¼ˆ0%ã€œ100%ï¼‰ã‚’å‡ç­‰ã«
  const percent = (cleared<=0)? 0 : (cleared/total)*100;
  if(!animate){ hero.style.transition = 'none'; }
  hero.style.left = `calc(${percent}% - 8px)`;
  if(!animate){ setTimeout(()=> hero.style.transition = '', 0); }
}

/* ================== ã‚»ãƒ¬ã‚¯ãƒˆï¼ˆå˜å…ƒ/å°å˜å…ƒï¼‰ ================== */
function initSelectors(){
  unitSelect.innerHTML = "";
  Object.keys(unitMap).sort((a,b)=>Number(a)-Number(b)).forEach(no=>{
    const opt = document.createElement('option');
    opt.value = no; opt.textContent = `å˜å…ƒ ${no}`;
    unitSelect.appendChild(opt);
  });
  unitSelect.addEventListener('change', refreshSubunits);

  subunitSelect.addEventListener('change', ()=> renderQuestion(true));
  refreshSubunits();
}
function refreshSubunits(){
  const no = unitSelect.value;
  const subs = unitMap[no] || [];
  subunitSelect.innerHTML = "";
  subs.forEach(s=>{
    const opt = document.createElement('option');
    opt.value = s; opt.textContent = s;
    subunitSelect.appendChild(opt);
  });
  renderQuestion(true);
}

/* ================== å•é¡Œæç”»ãƒ»è§£ç­”å‡¦ç† ================== */
function getList(sub){ return units[sub]||[]; }

function renderQuestion(resetCursor=false){
  const sub = subunitSelect.value;
  subunitTitle.textContent = sub||"-";
  const data = getProgress(sub);
  const list = getList(sub);
  if(list.length===0){
    qCounter.textContent = "0/0";
    questionText.textContent = "ã“ã®å°å˜å…ƒã«ã¯å•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“ã€‚";
    optionsDiv.innerHTML = ""; feedback.innerHTML="";
    progressText.textContent = `0/0`; progressBar.style.width = "0%";
    return;
  }
  if(resetCursor){
    if(data.cursor<0 || data.cursor>=list.length) data.cursor = 0;
    setProgress(sub, data);
  }
  const idx = data.cursor;
  const item = list[idx];

  qCounter.textContent = `${idx+1} / ${list.length}`;
  questionText.textContent = item.q;
  optionsDiv.innerHTML = "";
  feedback.innerHTML = "";

  // é€²æ—UI
  progressText.textContent = `${data.correct.length}/${list.length}`;
  progressBar.style.width = `${(data.correct.length/list.length)*100}%`;

  item.options.forEach((op, i)=>{
    const btn = document.createElement('button');
    btn.className = 'opt';
    btn.innerHTML = `<b>${i+1}.</b> ${op}`;
    btn.addEventListener('click', ()=> onAnswer(i+1));
    optionsDiv.appendChild(btn);
  });
}

function moveQuestion(delta){
  const sub = subunitSelect.value;
  const data = getProgress(sub);
  const list = getList(sub);
  data.cursor += delta;
  if(data.cursor < 0) data.cursor = list.length-1;
  if(data.cursor >= list.length) data.cursor = 0;
  setProgress(sub, data);
  renderQuestion();
}

document.getElementById('prevQ').addEventListener('click', ()=>moveQuestion(-1));
document.getElementById('nextQ').addEventListener('click', ()=>moveQuestion(1));

function onAnswer(choice){
  const sub = subunitSelect.value;
  const data = getProgress(sub);
  const list = getList(sub);
  const idx = data.cursor;
  const correctIdx = list[idx].answer;

  // è£…é£¾
  [...optionsDiv.children].forEach((b,i)=>{
    b.classList.remove('correct','wrong');
    if(i+1===choice) b.classList.add(choice===correctIdx?'correct':'wrong');
  });

  if(choice === correctIdx){
    // åˆå›æ­£è§£ãªã‚‰è¨˜éŒ²
    if(!data.correct.includes(idx)){
      data.correct.push(idx);
      setProgress(sub, data);
      // é€²æ—UIæ›´æ–°
      progressText.textContent = `${data.correct.length}/${list.length}`;
      progressBar.style.width = `${(data.correct.length/list.length)*100}%`;
      feedback.innerHTML = `<p style="color:var(--ok);font-weight:700">æ­£è§£ï¼</p>`;
    }else{
      feedback.innerHTML = `<p style="color:var(--ok);font-weight:700">æ­£è§£ï¼ï¼ˆã“ã®å•é¡Œã¯ã‚¯ãƒªã‚¢æ¸ˆã¿ï¼‰</p>`;
    }

    // === å°å˜å…ƒã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆåˆ¤å®šï¼ˆå…¨å•æ­£è§£ï¼‰===
    const completed = data.correct.length >= list.length;
    if(completed && !data.awarded){
      // ã‚¯ãƒªã‚¢æ‰±ã„ï¼šå®ç®± â†’ ãƒ©ãƒ³ãƒ€ãƒ ã‚­ãƒ£ãƒ©ï¼ˆè¢«ã‚Šã‚ã‚Šï¼‰
      data.awarded = true;
      setProgress(sub, data);

      // æ­©æ•°ï¼ˆè¸ç ´å°å˜å…ƒæ•°ï¼‰ã‚’+1
      const currentCleared = getClearedCount();
      setClearedCount(currentCleared + 1);

      // å®ç®±é–‹å°
      openTreasureModal(sub);
      // å†’é™ºãƒ‘ã‚¹æ›´æ–°ï¼†ãƒ’ãƒ¼ãƒ­ãƒ¼ç§»å‹•
      updateHeroPosition(true);
      // ãƒãƒ¼ãƒ‰ã®å®ç®±å°
      const node = [...pathDiv.children].find(n=>n.dataset.sub===sub);
      if(node) node.classList.add('treasure','done');
    }
  }else{
    feedback.innerHTML = `<p style="color:var(--danger);font-weight:700">ã–ã‚“ã­ã‚“ï¼ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã‚ˆã†</p>`;
  }
}

/* ================== å®ç®±ãƒ¢ãƒ¼ãƒ€ãƒ« ================== */
const modalBackdrop = document.getElementById('modalBackdrop');
const rewardImg = document.getElementById('rewardImg');
const modalTitle = document.getElementById('modalTitle');
const modalMessage = document.getElementById('modalMessage');
const chestEmoji = document.getElementById('chestEmoji');
document.getElementById('closeModalBtn').addEventListener('click', ()=> modalBackdrop.style.display='none');

function openTreasureModal(sub){
  const url = awardRandomCharacter();
  rewardImg.src = url;
  modalTitle.textContent = "å®ç®±ãŒé–‹ã„ãŸï¼";
  chestEmoji.textContent = "ğŸ§°";
  modalMessage.textContent = `${sub} ã‚’ã‚¯ãƒªã‚¢ï¼ æ–°ã—ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’ä»²é–“ã«ã—ãŸï¼`;
  modalBackdrop.style.display = 'flex';
}

/* ================== ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤º ================== */
function showCollection(){
  const grid = document.getElementById('collectionGrid');
  grid.innerHTML = "";
  const col = getCollection();
  if(col.length===0){
    grid.innerHTML = `<p class="muted">ã¾ã ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’æŒã£ã¦ã„ã¾ã›ã‚“ã€‚</p>`;
  }else{
    col.forEach(url=>{
      const img = document.createElement('img');
      img.src = url; grid.appendChild(img);
    });
  }
  collectionCard.style.display = "block";
}
document.getElementById('showCollectionBtn').addEventListener('click', showCollection);
document.getElementById('hideCollectionBtn').addEventListener('click', ()=> collectionCard.style.display="none");

/* ================== æ•™å¸«ãƒ¢ãƒ¼ãƒ‰ ================== */
document.getElementById('teacherBtn').addEventListener('click', ()=>{
  const pw = prompt("æ•™å¸«ãƒ¢ãƒ¼ãƒ‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
  if(pw === teacherPassword){
    teacherCard.style.display = "block";
  }else if(pw !== null){
    alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
  }
});
document.getElementById('switchUserBtn').addEventListener('click', ()=>{
  const name = prompt("åˆ‡ã‚Šæ›¿ãˆã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼‰ã‚’å…¥åŠ›");
  if(name && name.trim()){
    currentUser = name.trim();
    saveUser(currentUser);
    startApp();
    alert(`ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã€Œ${currentUser}ã€ã«åˆ‡ã‚Šæ›¿ãˆã¾ã—ãŸ`);
  }
});
document.getElementById('wipeBtn').addEventListener('click', ()=>{
  if(!confirm(`${currentUser} ã®å…¨ãƒ‡ãƒ¼ã‚¿ï¼ˆé€²æ—ãƒ»ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ»è¸ç ´ï¼‰ã‚’å‰Šé™¤ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ`)) return;
  Object.keys(localStorage).forEach(k=>{
    if(k.startsWith(`${VERSION}::${currentUser}::`)){
      localStorage.removeItem(k);
    }
  });
  startApp();
  alert("å‰Šé™¤ã—ã¾ã—ãŸ");
});
document.getElementById('exportBtn').addEventListener('click', ()=>{
  const dump = {};
  Object.keys(localStorage).forEach(k=>{
    if(k.startsWith(`${VERSION}::${currentUser}::`)){
      dump[k] = localStorage.getItem(k);
    }
  });
  const pre = document.getElementById('exportBox');
  pre.textContent = JSON.stringify(dump, null, 2);
  pre.style.display = "block";
});

/* ================== ãƒ­ã‚°ã‚¤ãƒ³ãƒ»èµ·å‹• ================== */
document.getElementById('loginBtn').addEventListener('click', ()=>{
  const name = (document.getElementById('nickname').value || "").trim();
  if(!name){ alert("ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"); return; }
  currentUser = name;
  saveUser(name);
  startApp();
});

function startApp(){
  loginCard.style.display = "none";
  adventureCard.style.display = "block";
  quizCard.style.display = "block";
  collectionCard.style.display = "none";
  teacherCard.style.display = "none";
  currentUserLabel.textContent = currentUser;

  // åˆå›ã«è¸ç ´æ•°ã‚’å†è¨ˆç®—ï¼ˆãƒ‡ãƒ¼ã‚¿äº’æ›ï¼‰
  const awardedCount = subunitsOrdered.filter(s => getProgress(s).awarded).length;
  setClearedCount(awardedCount);

  // å†’é™ºé“ï¼†ãƒ’ãƒ¼ãƒ­ãƒ¼
  renderAdventurePath();

  // ã‚»ãƒ¬ã‚¯ã‚¿
  initSelectors();
}

(function boot(){
  const saved = loadUser();
  if(saved){
    currentUser = saved;
    startApp();
  }else{
    loginCard.style.display = "block";
  }
})();
</script>
</body>
</html>
